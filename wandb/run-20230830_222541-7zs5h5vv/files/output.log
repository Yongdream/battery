08-30 22:25:47 method: DA
08-30 22:25:47 model_name: ALSTMAdFeatures
08-30 22:25:47 data_name: Battery
08-30 22:25:47 data_dir: ../processed
08-30 22:25:47 transfer_task: [[1], [0]]
08-30 22:25:47 normlizetype: mean-std
08-30 22:25:47 adabn: False
08-30 22:25:47 eval_all: False
08-30 22:25:47 adabn_epochs: 3
08-30 22:25:47 cuda_device: 0
08-30 22:25:47 checkpoint_dir: ./checkpoint
08-30 22:25:47 pretrained: False
08-30 22:25:47 batch_size: 128
08-30 22:25:47 num_workers: 0
08-30 22:25:47 seed: 3
08-30 22:25:47 patience: 50
08-30 22:25:47 bottleneck: True
08-30 22:25:47 bottleneck_num: 128
08-30 22:25:47 last_batch: False
08-30 22:25:47 distance_metric: True
08-30 22:25:47 distance_loss: JMMD
08-30 22:25:47 trade_off_distance: Step
08-30 22:25:47 lam_distance: 1.2
08-30 22:25:47 domain_adversarial: False
08-30 22:25:47 adversarial_loss: CDA
08-30 22:25:47 hidden_size: 1024
08-30 22:25:47 trade_off_adversarial: Step
08-30 22:25:47 lam_adversarial: 2
08-30 22:25:47 opt: adam
08-30 22:25:47 lr: 0.001
08-30 22:25:47 momentum: 0.9
08-30 22:25:47 weight_decay: 1e-05
08-30 22:25:47 lr_scheduler: step
08-30 22:25:47 gamma: 0.8
08-30 22:25:47 steps: 80, 95, 105
08-30 22:25:47 criterion: CeLoss
08-30 22:25:47 middle_epoch: 25
08-30 22:25:47 max_epoch: 50
08-30 22:25:47 print_step: 600
08-30 22:25:47 wandb: True
08-30 22:25:47 using 1 gpus

100%|██████████| 3/3 [00:04<00:00,  1.52s/it]


100%|██████████| 3/3 [00:04<00:00,  1.56s/it]
08-30 22:26:02 ==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Sequential                               [128, 3]                  --
├─ALSTMAdFeatures: 1-1                   [128, 128]                --
│    └─Sequential: 2-1                   [128, 60, 300]            --
│    │    └─Conv1d: 3-1                  [128, 32, 300]            2,720
│    │    └─ReLU: 3-2                    [128, 32, 300]            --
│    │    └─Conv1d: 3-3                  [128, 60, 300]            5,820
│    │    └─ReLU: 3-4                    [128, 60, 300]            --
│    └─GRU: 2-2                          [128, 300, 64]            124,800
│    └─GRU: 2-3                          [128, 300, 32]            27,072
│    └─Sequential: 2-4                   [128, 300, 1]             --
│    │    └─Linear: 3-5                  [128, 300, 16]            528
│    │    └─ReLU: 3-6                    [128, 300, 16]            --
│    │    └─Linear: 3-7                  [128, 300, 1]             16
│    │    └─Softmax: 3-8                 [128, 300, 1]             --
│    └─Linear: 2-5                       [128, 2048]               19,662,848
│    └─Linear: 2-6                       [128, 128]                262,272
├─Sequential: 1-2                        [128, 128]                --
│    └─Linear: 2-7                       [128, 128]                16,512
│    └─ReLU: 2-8                         [128, 128]                --
│    └─Dropout: 2-9                      [128, 128]                --
├─Linear: 1-3                            [128, 3]                  387
==========================================================================================
Total params: 20,102,975
Trainable params: 20,102,975
Non-trainable params: 0
Total mult-adds (G): 8.71
==========================================================================================
Input size (MB): 1.84
Forward/backward pass size (MB): 65.34
Params size (MB): 80.41
Estimated Total Size (MB): 147.59
==========================================================================================
08-30 22:26:02 -----Epoch 0/49-----
08-30 22:26:02 current lr: [0.001, 0.001, 0.001]
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Sequential                               [128, 3]                  --
├─ALSTMAdFeatures: 1-1                   [128, 128]                --
│    └─Sequential: 2-1                   [128, 60, 300]            --
│    │    └─Conv1d: 3-1                  [128, 32, 300]            2,720
│    │    └─ReLU: 3-2                    [128, 32, 300]            --
│    │    └─Conv1d: 3-3                  [128, 60, 300]            5,820
│    │    └─ReLU: 3-4                    [128, 60, 300]            --
│    └─GRU: 2-2                          [128, 300, 64]            124,800
│    └─GRU: 2-3                          [128, 300, 32]            27,072
│    └─Sequential: 2-4                   [128, 300, 1]             --
│    │    └─Linear: 3-5                  [128, 300, 16]            528
│    │    └─ReLU: 3-6                    [128, 300, 16]            --
│    │    └─Linear: 3-7                  [128, 300, 1]             16
│    │    └─Softmax: 3-8                 [128, 300, 1]             --
│    └─Linear: 2-5                       [128, 2048]               19,662,848
│    └─Linear: 2-6                       [128, 128]                262,272
├─Sequential: 1-2                        [128, 128]                --
│    └─Linear: 2-7                       [128, 128]                16,512
│    └─ReLU: 2-8                         [128, 128]                --
│    └─Dropout: 2-9                      [128, 128]                --
├─Linear: 1-3                            [128, 3]                  387
==========================================================================================
Total params: 20,102,975
Trainable params: 20,102,975
Non-trainable params: 0
Total mult-adds (G): 8.71
==========================================================================================
Input size (MB): 1.84
Forward/backward pass size (MB): 65.34
Params size (MB): 80.41
Estimated Total Size (MB): 147.59
==========================================================================================
Model build successfully!
08-30 22:26:03 Epoch: 0 [0/7172], Train Loss: 1.0878 Train Acc: 0.3828,141.5 examples/sec 0.90 sec/batch
08-30 22:26:07 Epoch: 0 source_train-Loss: 0.8384 source_train-Acc: 0.5935, Cost 4.5 sec
Isc recall: 0
08-30 22:26:07 Epoch: 0 source_val-Loss: 0.5577 source_val-Acc: 0.7780, Cost 0.3 sec
08-30 22:26:08 Epoch: 0 target_val-Loss: 0.6206 target_val-Acc: 0.7525, Cost 0.5 sec
08-30 22:26:08 -----Epoch 1/49-----
08-30 22:26:08 current lr: [0.001, 0.001, 0.001]
08-30 22:26:11 Epoch: 1 source_train-Loss: 0.5451 source_train-Acc: 0.7905, Cost 3.2 sec
Isc recall: 0
08-30 22:26:11 Epoch: 1 source_val-Loss: 0.5280 source_val-Acc: 0.7946, Cost 0.3 sec
08-30 22:26:12 Epoch: 1 target_val-Loss: 0.5458 target_val-Acc: 0.8022, Cost 0.4 sec
08-30 22:26:12 -----Epoch 2/49-----
08-30 22:26:12 current lr: [0.001, 0.001, 0.001]
08-30 22:26:15 Epoch: 2 source_train-Loss: 0.5341 source_train-Acc: 0.7935, Cost 3.3 sec
08-30 22:26:15 Epoch: 2 source_val-Loss: 0.5280 source_val-Acc: 0.7946, Cost 0.3 sec
Isc recall: 0
08-30 22:26:16 Epoch: 2 target_val-Loss: 0.5328 target_val-Acc: 0.8035, Cost 0.5 sec
08-30 22:26:16 -----Epoch 3/49-----
